#!/bin/sh

# =============================================================================
# 커밋 메시지 컨벤션 검사 스크립트
# =============================================================================
# 
# [추후 논의] commitlint 도입 검토
# - 현재: Shell script로 기본 검증 (추가 패키지 없음)
# - 대안: @commitlint/cli + @commitlint/config-conventional
#
# =============================================================================

commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# 허용되는 커밋 타입 정의
pattern="^(feat|fix|docs|style|refactor|test|chore|design|comment|rename|remove|hotfix)(\!)?\: .+$"

if ! echo "$commit_msg" | grep -qE "$pattern"; then
  echo ""
  echo "❌ 커밋 메시지가 컨벤션에 맞지 않습니다."
  echo ""
  echo "올바른 형식: <type>: <subject>"
  echo ""
  echo "허용되는 타입:"
  echo "  feat     - 새로운 기능 추가"
  echo "  fix      - 버그 수정"
  echo "  docs     - 문서 수정"
  echo "  style    - 코드 formatting (코드 변경 없음)"
  echo "  refactor - 코드 리팩토링"
  echo "  test     - 테스트 코드"
  echo "  chore    - 기타 수정"
  echo "  design   - UI 디자인 변경"
  echo "  comment  - 주석 추가/변경"
  echo "  rename   - 파일/폴더 이름 변경"
  echo "  remove   - 파일 삭제"
  echo "  hotfix   - 긴급 버그 수정"
  echo ""
  echo "예시:"
  echo "  feat: 로그인 기능 추가"
  echo "  fix: 버튼 클릭 오류 수정"
  echo "  feat!: API 응답 구조 변경 (BREAKING CHANGE)"
  echo ""
  exit 1
fi
